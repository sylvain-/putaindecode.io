{"head":{"layout":"Post","comments":true,"date":"2017-03-08","title":"Formatez votre JavaScript avec prettier","tags":["javascript","tools","prettier"],"authors":["zoontek"],"description":"Rob Pike et Ken Thompson ont con√ßu le langage de programmation Go de fa√ßon √† ce que celui-ci soit √† port√©e des jeunes d√©veloppeurs : si‚Ä¶"},"body":"<p>Rob Pike et Ken Thompson ont con√ßu le langage de programmation Go de fa√ßon √† ce\nque celui-ci soit √† port√©e des jeunes d√©veloppeurs : si vous d√©couvrez et\ncommencez √† apprendre le Go le lundi, vous devriez √™tre en mesure d'√™tre\nproductif le mercredi. Le langage est extr√™mement minimaliste, il y a rarement\nplus d'une fa√ßon de faire quelque chose.</p>\n<p>Seulement voil√†, le d√©veloppeur tortur√© se posera toujours un tas de questions\nessentielles : tabs ou spaces ? 2, 4 ou 8 spaces ? Single quotes ou double\nquotes ? Apr√®s quelles structures de contr√¥le passer une ligne ? Mais aussi les\n√©ternels : vim ou emacs ? Flow ou TypeScript ? Maintenir ce projet Angular 1 ou\nd√©missionner comme un prince ?</p>\n<p><em>N.B. : Pour information, les bonnes r√©ponses sont bien √©videmment spaces, 2,\nsingle quotes, vim, flow, la d√©mission</em></p>\n<p>C'est pour r√©pondre √† ce probl√®me (enfin, ceux li√©s au formatage de votre code)\nque Go int√®gre un formatting tool (<code>fmt</code>, comme la commande Unix), intitul√©\n<a href=\"https://golang.org/cmd/gofmt/\">gofmt</a>.</p>\n<ol>\n<li>Vous codez comme vous le sentez</li>\n<li>Vous sauvegardez votre fichier</li>\n<li>Votre code est automatiquement format√©</li>\n<li>Vous vous sentez frustr√©</li>\n<li>Tr√®s vite, vous vous rendez compte que c'est pour votre bien, et que perdre\ndu temps ou d√©battre sur ce genre de d√©tails, c'est tout sauf utile</li>\n</ol>\n<p>Autre avantage non n√©gligeable : le code Go que vous trouverez dans d'autres\npackages, des exemples, etc. sera toujours format√© de la m√™me fa√ßon.</p>\n<p><em>√Ä noter : Reason offre quelque chose de similaire avec\n<a href=\"https://facebook.github.io/reason/tools.html\">refmt</a>.</em></p>\n<p>Cette solution officielle n'existe pas en JS. Mais c'est ici qu'intervient\n<a href=\"https://github.com/prettier/prettier\">prettier</a> (et non\n<a href=\"https://www.npmjs.com/package/jsfmt\">jsfmt</a>, qui existe mais ne semble plus\nmaintenu), un projet relativement r√©cent, en version <code>0.21</code> √† l'heure o√π j'√©cris\nces lignes. Compatible <em>out of the box</em> avec le JS ES2017, JSX, flow, il offre\n√©galement le moins de configuration possible (ce qui est une bonne chose). Le\nprojet est activement suivi par Facebook, qui discute m√™me la possibilit√© de\ns'en servir sur la codebase de\n<a href=\"https://github.com/facebook/react/pull/9101\">React</a>.</p>\n<h2 id=\"comment-√ßa-fonctionne-\"><a href=\"#comment-%C3%A7a-fonctionne-\" class=\"phenomic-HeadingAnchor\">#</a>Comment √ßa fonctionne ?</h2>\n<p>Croyez-le ou non, ce n'est pas \"tellement\" complexe. √Ä la mani√®re de babel ou\nflow, prettier utilise un AST parser (Abstract Syntax Tree parser) afin\nd'analyser le contenu de votre fichier JS, suite √† quoi il va simplement\nformater votre code sans tenir compte de la forme pr√©c√©dente, en ne gardant que\nce qui est important: le fond, pas la forme.</p>\n<p>Je vous invite √† jouer avec <a href=\"https://astexplorer.net/\">AST explorer</a> pour\ncomprendre beaucoup plus simplement comment tout cela fonctionne.</p>\n<h2 id=\"installation\"><a href=\"#installation\" class=\"phenomic-HeadingAnchor\">#</a>Installation</h2>\n<pre><code class=\"hljs language-console\">npm install --save-dev prettier</code></pre>\n<p>Ou, pour les meilleurs d'entre vous :</p>\n<pre><code class=\"hljs language-console\">yarn add --dev prettier</code></pre>\n<p>¬Ø\\<em>( „ÉÑ )</em>/¬Ø</p>\n<h2 id=\"configuration\"><a href=\"#configuration\" class=\"phenomic-HeadingAnchor\">#</a>Configuration</h2>\n<p>Car oui, il y en a tout de m√™me un peu. Il est possible de r√©gler:</p>\n<ul>\n<li>La longueur maximale des lignes (<code>printWidth</code>, <code>80</code> caract√®res par d√©faut)</li>\n<li>Le nombre d'espaces pour l'indentation (<code>tabWidth</code>, <code>2</code> par d√©faut, pas de\ntabs)</li>\n<li>Single quotes / double quotes (<code>singleQuote</code>, <code>false</code> par d√©faut)</li>\n<li>S'il faut ajouter des virgules en fin de certaines structures (comme les\nobjets, mais aussi dans les param√®tres de fonction, ce qui est possible depuis\npeu) (<code>trailingComma</code>, <code>none</code> par d√©faut, <code>es5</code> et <code>all</code> sont √©galement\npossibles)</li>\n<li>S'il faut ajouter des espaces dans un objet √©crit sur une seule ligne\n(<code>bracketSpacing</code>, <code>true</code> par d√©faut)</li>\n<li>Comment fermer les balises JSX (<code>jsxBracketSameLine</code>, <code>false</code> par d√©faut)</li>\n<li>Quel parser utiliser (<code>parser</code>, <code>babylon</code> par d√©faut, <code>flow</code> est disponible)</li>\n</ul>\n<blockquote>\n<p>Mais attends‚Ä¶ Si l'on peut malgr√© tout configurer tout √ßa, ce n'est plus\nvraiment un style standard ?</p>\n</blockquote>\n<p>Oui et non, car il y aura toujours beaucoup de d√©tails sur lesquels il nous sera\nimpossible de choisir, les options resteront minimalistes. Par exemple, vous ne\npourrez jamais retirer les points-virgules.</p>\n<p><code>EDIT: Il semblerait que malgr√© ce qui a pu √™tre annonc√© par l'auteur de prettier, une option --no-semicolons soit dans les tuyaux.</code></p>\n<p>Dans tous les cas, prettier reste un outil extr√™mement pratique pour forcer le\nformatage du code au sein de votre √©quipe.</p>\n<p>Ouvrez votre <code>package.json</code>, c'est parti.</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">\"scripts\"</span>: {\n    <span class=\"hljs-attr\">\"prettify\"</span>: <span class=\"hljs-string\">\"prettier src/**/*.js\"</span>\n  },\n  <span class=\"hljs-attr\">\"devDependencies\"</span>: {\n    <span class=\"hljs-attr\">\"prettier\"</span>: <span class=\"hljs-string\">\"^0.21.0\"</span>\n  }\n}</code></pre>\n<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront automatiquement tous les\nfichiers <code>.js</code> contenus dans votre dossier <code>/src</code>. Bon j'avoue, c'est assez\nbasique comme usage. Ajoutons-y notre config pr√©f√©r√©e.</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">\"scripts\"</span>: {\n    <span class=\"hljs-attr\">\"prettify\"</span>:\n      <span class=\"hljs-string\">\"prettier --single-quote --trailing-comma all --write '{src,__{tests,mocks}__}/**/*.js'\"</span>\n  },\n  <span class=\"hljs-attr\">\"devDependencies\"</span>: {\n    <span class=\"hljs-attr\">\"prettier\"</span>: <span class=\"hljs-string\">\"^0.21.0\"</span>\n  }\n}</code></pre>\n<p><code>npm run prettify</code> ou <code>yarn run prettify</code> formateront maintenant automatiquement\ntous les fichiers <code>.js</code> contenus dans vos dossiers <code>/src</code>, <code>__tests__</code> et\n<code>__mocks__</code>, en utilisant le parser de flow, pr√©f√©rant les single quotes et en\najoutant une virgule en fin de chaque structure possible.</p>\n<p>OK. Mais si un membre de l'√©quipe oublie d'ex√©cuter le script avant de commiter\nson code ? <strong>We got this !</strong> (avec 2 d√©pendances de plus).</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">\"scripts\"</span>: {\n    <span class=\"hljs-attr\">\"precommit\"</span>: <span class=\"hljs-string\">\"lint-staged\"</span>,\n    <span class=\"hljs-attr\">\"prettify\"</span>:\n      <span class=\"hljs-string\">\"prettier --single-quote --trailing-comma all --write '{src,__{tests,mocks}__}/**/*.js'\"</span>\n  },\n  <span class=\"hljs-attr\">\"lint-staged\"</span>: {\n    <span class=\"hljs-attr\">\"{src,__{tests,mocks}__}/**/*.js\"</span>: [\n      <span class=\"hljs-string\">\"prettier --single-quote --trailing-comma all --write\"</span>,\n      <span class=\"hljs-string\">\"git add\"</span>\n    ]\n  },\n  <span class=\"hljs-attr\">\"devDependencies\"</span>: {\n    <span class=\"hljs-attr\">\"husky\"</span>: <span class=\"hljs-string\">\"^0.13.2\"</span>,\n    <span class=\"hljs-attr\">\"lint-staged\"</span>: <span class=\"hljs-string\">\"^3.3.1\"</span>,\n    <span class=\"hljs-attr\">\"prettier\"</span>: <span class=\"hljs-string\">\"^0.21.0\"</span>\n  }\n}</code></pre>\n<h2 id=\"les-plugins\"><a href=\"#les-plugins\" class=\"phenomic-HeadingAnchor\">#</a>Les plugins</h2>\n<p>Si vous ne pouvez pas attendre le moment du commit pour admirer votre code\nfraichement format√©, il existe d√©j√† pas mal de plugins, pour pas mal d'√©diteurs\n: <code>prettier-atom</code>, <code>prettier-vscode</code>, <code>Jsprettier</code> (pour Sublime Text), mais\naussi pour emacs, vim, les IDE Jetbrain, etc. Tout est dans le\n<a href=\"https://github.com/prettier/prettier/blob/master/README.md\">README</a>.</p>\n<p><em>Protip: Inutile de vous conforter au style de formatage de votre √©quipe au sein\nde votre √©diteur si le code est √† nouveau format√© en pre-commit.</em></p>\n<h2 id=\"quelques-exemples-cest-possible-\"><a href=\"#quelques-exemples-cest-possible-\" class=\"phenomic-HeadingAnchor\">#</a>Quelques exemples, c'est possible ?</h2>\n<p>J'ai mieux. Il est possible d'<a href=\"https://prettier.github.io/prettier\">essayer en\nligne</a> ! ‚ú®</p>\n<h2 id=\"donc-cest-bon-tu-conseilles-\"><a href=\"#donc-cest-bon-tu-conseilles-\" class=\"phenomic-HeadingAnchor\">#</a>Donc c'est bon, tu conseilles ?</h2>\n<p>C'est tout de m√™me √† r√©fl√©chir. Le projet est encore jeune et en beta, m√™me s'il\n√©volue extr√™mement vite. Tout n'est pas encore parfaitement support√©, mais je\nvous rassure, si vous n'utilisez pas le flow-parser vous ne risquez pas de\nrencontrer beaucoup de probl√®mes avec la derni√®re version.</p>\n<p>Des projets tels que\n<a href=\"https://github.com/facebook/immutable-js/commit/9bcc8b54a17c3bbc94d70864121784bc91011e8f\">immutable-js</a>,\n<a href=\"https://github.com/necolas/react-native-web/commit/a2f25a46c495ca53a75e728cfb14dbdf67cdb342\">react-native-web</a>\net\n<a href=\"https://github.com/babel/babel/commit/bdbe2cfbc5ab5ba6f528b7ee3e4bf5ed940a47af\">babel</a>\ny sont d√©j√† pass√©s. Pourquoi pas vous ? üòâ</p>\n","rawBody":"\nRob Pike et Ken Thompson ont con√ßu le langage de programmation Go de fa√ßon √† ce\nque celui-ci soit √† port√©e des jeunes d√©veloppeurs : si vous d√©couvrez et\ncommencez √† apprendre le Go le lundi, vous devriez √™tre en mesure d'√™tre\nproductif le mercredi. Le langage est extr√™mement minimaliste, il y a rarement\nplus d'une fa√ßon de faire quelque chose.\n\nSeulement voil√†, le d√©veloppeur tortur√© se posera toujours un tas de questions\nessentielles : tabs ou spaces ? 2, 4 ou 8 spaces ? Single quotes ou double\nquotes ? Apr√®s quelles structures de contr√¥le passer une ligne ? Mais aussi les\n√©ternels : vim ou emacs ? Flow ou TypeScript ? Maintenir ce projet Angular 1 ou\nd√©missionner comme un prince ?\n\n_N.B. : Pour information, les bonnes r√©ponses sont bien √©videmment spaces, 2,\nsingle quotes, vim, flow, la d√©mission_\n\nC'est pour r√©pondre √† ce probl√®me (enfin, ceux li√©s au formatage de votre code)\nque Go int√®gre un formatting tool (`fmt`, comme la commande Unix), intitul√©\n[gofmt](https://golang.org/cmd/gofmt/).\n\n1. Vous codez comme vous le sentez\n2. Vous sauvegardez votre fichier\n3. Votre code est automatiquement format√©\n4. Vous vous sentez frustr√©\n5. Tr√®s vite, vous vous rendez compte que c'est pour votre bien, et que perdre\n   du temps ou d√©battre sur ce genre de d√©tails, c'est tout sauf utile\n\nAutre avantage non n√©gligeable : le code Go que vous trouverez dans d'autres\npackages, des exemples, etc. sera toujours format√© de la m√™me fa√ßon.\n\n_√Ä noter : Reason offre quelque chose de similaire avec\n[refmt](https://facebook.github.io/reason/tools.html)._\n\nCette solution officielle n'existe pas en JS. Mais c'est ici qu'intervient\n[prettier](https://github.com/prettier/prettier) (et non\n[jsfmt](https://www.npmjs.com/package/jsfmt), qui existe mais ne semble plus\nmaintenu), un projet relativement r√©cent, en version `0.21` √† l'heure o√π j'√©cris\nces lignes. Compatible _out of the box_ avec le JS ES2017, JSX, flow, il offre\n√©galement le moins de configuration possible (ce qui est une bonne chose). Le\nprojet est activement suivi par Facebook, qui discute m√™me la possibilit√© de\ns'en servir sur la codebase de\n[React](https://github.com/facebook/react/pull/9101).\n\n## Comment √ßa fonctionne ?\n\nCroyez-le ou non, ce n'est pas \"tellement\" complexe. √Ä la mani√®re de babel ou\nflow, prettier utilise un AST parser (Abstract Syntax Tree parser) afin\nd'analyser le contenu de votre fichier JS, suite √† quoi il va simplement\nformater votre code sans tenir compte de la forme pr√©c√©dente, en ne gardant que\nce qui est important: le fond, pas la forme.\n\nJe vous invite √† jouer avec [AST explorer](https://astexplorer.net/) pour\ncomprendre beaucoup plus simplement comment tout cela fonctionne.\n\n## Installation\n\n```console\nnpm install --save-dev prettier\n```\n\nOu, pour les meilleurs d'entre vous :\n\n```console\nyarn add --dev prettier\n```\n\n¬Ø\\\\*( „ÉÑ )*/¬Ø\n\n## Configuration\n\nCar oui, il y en a tout de m√™me un peu. Il est possible de r√©gler:\n\n* La longueur maximale des lignes (`printWidth`, `80` caract√®res par d√©faut)\n* Le nombre d'espaces pour l'indentation (`tabWidth`, `2` par d√©faut, pas de\n  tabs)\n* Single quotes / double quotes (`singleQuote`, `false` par d√©faut)\n* S'il faut ajouter des virgules en fin de certaines structures (comme les\n  objets, mais aussi dans les param√®tres de fonction, ce qui est possible depuis\n  peu) (`trailingComma`, `none` par d√©faut, `es5` et `all` sont √©galement\n  possibles)\n* S'il faut ajouter des espaces dans un objet √©crit sur une seule ligne\n  (`bracketSpacing`, `true` par d√©faut)\n* Comment fermer les balises JSX (`jsxBracketSameLine`, `false` par d√©faut)\n* Quel parser utiliser (`parser`, `babylon` par d√©faut, `flow` est disponible)\n\n> Mais attends‚Ä¶ Si l'on peut malgr√© tout configurer tout √ßa, ce n'est plus\n> vraiment un style standard ?\n\nOui et non, car il y aura toujours beaucoup de d√©tails sur lesquels il nous sera\nimpossible de choisir, les options resteront minimalistes. Par exemple, vous ne\npourrez jamais retirer les points-virgules.\n\n`EDIT: Il semblerait que malgr√© ce qui a pu √™tre annonc√© par l'auteur de\nprettier, une option --no-semicolons soit dans les tuyaux.`\n\nDans tous les cas, prettier reste un outil extr√™mement pratique pour forcer le\nformatage du code au sein de votre √©quipe.\n\nOuvrez votre `package.json`, c'est parti.\n\n```json\n{\n  \"scripts\": {\n    \"prettify\": \"prettier src/**/*.js\"\n  },\n  \"devDependencies\": {\n    \"prettier\": \"^0.21.0\"\n  }\n}\n```\n\n`npm run prettify` ou `yarn run prettify` formateront automatiquement tous les\nfichiers `.js` contenus dans votre dossier `/src`. Bon j'avoue, c'est assez\nbasique comme usage. Ajoutons-y notre config pr√©f√©r√©e.\n\n```json\n{\n  \"scripts\": {\n    \"prettify\":\n      \"prettier --single-quote --trailing-comma all --write '{src,__{tests,mocks}__}/**/*.js'\"\n  },\n  \"devDependencies\": {\n    \"prettier\": \"^0.21.0\"\n  }\n}\n```\n\n`npm run prettify` ou `yarn run prettify` formateront maintenant automatiquement\ntous les fichiers `.js` contenus dans vos dossiers `/src`, `__tests__` et\n`__mocks__`, en utilisant le parser de flow, pr√©f√©rant les single quotes et en\najoutant une virgule en fin de chaque structure possible.\n\nOK. Mais si un membre de l'√©quipe oublie d'ex√©cuter le script avant de commiter\nson code ? **We got this !** (avec 2 d√©pendances de plus).\n\n```json\n{\n  \"scripts\": {\n    \"precommit\": \"lint-staged\",\n    \"prettify\":\n      \"prettier --single-quote --trailing-comma all --write '{src,__{tests,mocks}__}/**/*.js'\"\n  },\n  \"lint-staged\": {\n    \"{src,__{tests,mocks}__}/**/*.js\": [\n      \"prettier --single-quote --trailing-comma all --write\",\n      \"git add\"\n    ]\n  },\n  \"devDependencies\": {\n    \"husky\": \"^0.13.2\",\n    \"lint-staged\": \"^3.3.1\",\n    \"prettier\": \"^0.21.0\"\n  }\n}\n```\n\n## Les plugins\n\nSi vous ne pouvez pas attendre le moment du commit pour admirer votre code\nfraichement format√©, il existe d√©j√† pas mal de plugins, pour pas mal d'√©diteurs\n: `prettier-atom`, `prettier-vscode`, `Jsprettier` (pour Sublime Text), mais\naussi pour emacs, vim, les IDE Jetbrain, etc. Tout est dans le\n[README](https://github.com/prettier/prettier/blob/master/README.md).\n\n_Protip: Inutile de vous conforter au style de formatage de votre √©quipe au sein\nde votre √©diteur si le code est √† nouveau format√© en pre-commit._\n\n## Quelques exemples, c'est possible ?\n\nJ'ai mieux. Il est possible d'[essayer en\nligne](https://prettier.github.io/prettier) ! ‚ú®\n\n## Donc c'est bon, tu conseilles ?\n\nC'est tout de m√™me √† r√©fl√©chir. Le projet est encore jeune et en beta, m√™me s'il\n√©volue extr√™mement vite. Tout n'est pas encore parfaitement support√©, mais je\nvous rassure, si vous n'utilisez pas le flow-parser vous ne risquez pas de\nrencontrer beaucoup de probl√®mes avec la derni√®re version.\n\nDes projets tels que\n[immutable-js](https://github.com/facebook/immutable-js/commit/9bcc8b54a17c3bbc94d70864121784bc91011e8f),\n[react-native-web](https://github.com/necolas/react-native-web/commit/a2f25a46c495ca53a75e728cfb14dbdf67cdb342)\net\n[babel](https://github.com/babel/babel/commit/bdbe2cfbc5ab5ba6f528b7ee3e4bf5ed940a47af)\ny sont d√©j√† pass√©s. Pourquoi pas vous ? üòâ\n","__filename":"fr/articles/js/prettier/index.md","__url":"/fr/articles/js/prettier/","__resourceUrl":"/fr/articles/js/prettier/index.html","__dataUrl":"/fr/articles/js/prettier/index.html.9d6f0f1cf838ad08a610d2dfc99b3e72.json"}